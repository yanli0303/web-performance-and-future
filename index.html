<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">

        <title>Web - Performance and Future</title>

        <meta name="description" content="Web performance tuning with HTTP/1; and the future of the web - HTTP/2">
        <meta name="author" content="Yan Li">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

        <link rel="stylesheet" href="css/reveal.min.css">
        <link rel="stylesheet" href="css/theme/black.min.css" id="theme">

        <!-- Code syntax highlighting -->
        <link rel="stylesheet" href="lib/css/zenburn.min.css">

        <!-- My Styles -->
        <link rel="stylesheet" href="css/yali.min.css">

        <!-- Open any link on this page in a new browser window -->
        <base target="_blank" />

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.min.css' : 'css/print/paper.min.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section id="welcome">
                    <section id="landing">
                        <h1>Web</h1>
                        <h2>Performance and Future</h2>
                        <p>
                            <small>Yan (Peter) Li / Sep 2015</small>
                        </p>
                    </section>
                    <section id="qr-online" data-transition="none">
                        <img data-src="images/qr-online-min.png" alt="http://10.197.38.188/velocity" />
                        <p><a href="http://10.197.38.188/velocity">http://10.197.38.188/velocity</a></p>
                        <p>View online</p>
                    </section>
                    <section id="qr-pdf" data-transition="fade">
                        <img data-src="images/qr-pdf-min.png" alt="http://10.197.38.188/velocity/pdf" />
                        <p><a href="http://10.197.38.188/velocity/pdf">http://10.197.38.188/velocity/pdf</a></p>
                        <p>Download PDF</p>
                    </section>
                </section>

                <section id="intro">
                    <section id="whoami">
                        <h2>Hello, I'm Yan</h2>
                        <table class="no-border">
                            <tbody>
                                <tr>
                                    <td><img data-src="images/yan-usher-badge-tilt-min.png" alt="Yan Li Usher Badge"/></td>
                                    <td>
                                        <ul>
                                            <li>Joined MSTR in July 2008</li>
                                            <li>Work on Usher Network Manager</li>
                                            <li>Love Web</li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </section>

                    <section id="agenda">
                        <h2>Topic</h2>
                        <ul>
                            <li class="fragment">Web Performance Tuning</li>
                            <li class="fragment">Brief Introduction to HTTP/2</li>
                            <li class="fragment">A little on HTTPS</li>
                        </ul>
                        <p class="fragment">Hope it helps!</p>
                    </section>

                    <section id="do-you-know-web">
                        <h2>Do you know web?</h2>
                        <table class="no-border align-center">
                            <tbody>
                                <tr>
                                    <td style="width:45%"><span class="square border-round bg-blue">Frontend</span></td>
                                    <td>+</td>
                                    <td style="width:45%"><span class="square border-round bg-green">Backend</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </section>

                    <section id="page-size-trend">
                        <h2>Page Size (top 1000)</h2>
                        <table>
                            <thead>
                                <th>Year</th>
                                <th>Requests</th>
                                <th>Avg. Transfer Size</th>
                                <th>Growth</th>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>12/17/2010</td>
                                    <td>82</td>
                                    <td>655 KB</td>
                                    <td>N/A</td>
                                </tr>
                                <tr>
                                    <td>12/15/2011</td>
                                    <td>90</td>
                                    <td>810 KB</td>
                                    <td>24%</td>
                                </tr>
                                <tr>
                                    <td>12/15/2012</td>
                                    <td>99</td>
                                    <td>1163 KB</td>
                                    <td>44%</td>
                                </tr>
                                <tr>
                                    <td>12/15/2013</td>
                                    <td>112</td>
                                    <td>1607 KB</td>
                                    <td>38%</td>
                                </tr>
                                <tr>
                                    <td>12/15/2014</td>
                                    <td>117</td>
                                    <td>1834 KB</td>
                                    <td>14%</td>
                                </tr>
                                <tr class="fragment">
                                    <td>08/15/2015</td>
                                    <td>128</td>
                                    <td>2008 KB</td>
                                    <td>9%</td>
                                </tr>
                            </tbody>
                        </table>
                        <p>
                            <small>
                                <a href="http://httparchive.org/trends.php">http://httparchive.org/trends.php</a>
                            </small>
                        </p>
                    </section>

                    <section id="page-size-demo">
                        <h2>Page Size</h2>
                        <table>
                            <thead>
                                <tr>
                                    <th>Site</th>
                                    <th>Requests</th>
                                    <th>Size</th>
                                    <th>Time</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>www.163.com</td>
                                    <td>434</td>
                                    <td>3.6 MB</td>
                                    <td>1.7 min</td>
                                </tr>
                                <tr>
                                    <td>www.taobao.com</td>
                                    <td>116</td>
                                    <td>1.3 MB</td>
                                    <td>40.35 s</td>
                                </tr>
                                <tr>
                                    <td>www.jd.com</td>
                                    <td>79</td>
                                    <td>1.6 MB</td>
                                    <td>1.2 min</td>
                                </tr>
                                <tr>
                                    <td>www.microsoft.com</td>
                                    <td>76</td>
                                    <td>2.2 MB</td>
                                    <td>16.79 s</td>
                                </tr>
                                <tr>
                                    <td>www.microstrategy.com</td>
                                    <td>81</td>
                                    <td>1.1 MB</td>
                                    <td>37.29 s</td>
                                </tr>
                            </tbody>
                        </table>
                    </section>

                    <section id="network-speed">
                        <h2>Network speed</h2>
                        <table style="font-size:90%" class="bordered align-center">
                            <thead>
                                <tr>
                                    <th colspan="2">Desktop</th>
                                    <th colspan="3">Mobile</th>
                                </tr>
                                <tr>
                                    <th>Data rate</th>
                                    <th>Latency</th>
                                    <th>G</th>
                                    <th>Data rate</th>
                                    <th>Latency</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td rowspan="3">10 Mbps<br/>100 Mbps<br/>1 Gbps</td>
                                    <td rowspan="3">65-145 ms</td>
                                    <td>2G</td>
                                    <td>100-400 Kbps</td>
                                    <td>300-1000 ms</td>
                                </tr>
                                <tr>
                                    <td>3G</td>
                                    <td>0.5-1 Mbps</td>
                                    <td>100-500 ms</td>
                                </tr>
                                <tr>
                                    <td>4G</td>
                                    <td>1-50 Mbps</td>
                                    <td>&lt;100 ms</td>
                                </tr>
                            </tbody>
                        </table>
                        <p>
                            <small>
                                <a href="http://www.webperformancetoday.com/2012/04/02/mobile-versus-desktop-latency/">http://www.webperformancetoday.com/2012/04/02/mobile-versus-desktop-latency/</a>
                                <br/>
                                <a href="http://chimera.labs.oreilly.com/books/1230000000545/ch07.html#_brief_history_of_the_g_8217_s">http://chimera.labs.oreilly.com/books/1230000000545/ch07.html#_brief_history_of_the_g_8217_s</a>
                            </small>
                        </p>
                    </section>
                </section>

                <section id="latency">
                    <section id="faster-web">
                        <h2>Faster web sites</h2>
                        <p>What rules/best practices do you know?</p>
                    </section>
                    <section id="yahoo">
                        <h2>YAHOO! Best Practices</h2>
                        <ol>
                            <li>Make Fewer HTTP Requests</li>
                            <li>Use a CDN</li>
                            <li>Add Expires or Cache-Control Header</li>
                            <li>Gzip Components</li>
                            <li>Put Stylesheets at Top</li>
                            <li>Put Scripts at Bottom</li>
                            <li>...</li>
                        </ol>
                        <p><a href="https://developer.yahoo.com/performance/rules.html">https://developer.yahoo.com/performance/rules.html</a></p>
                    </section>
                    <section id="google-page-speed">
                        <h2>Google PageSpeed insights</h2>
                        <p><a href="https://developers.google.com/speed/pagespeed/insights/">https://developers.google.com/speed/pagespeed/insights/</a></p>
                        <!--<p><a href="https://developers.google.com/speed/pagespeed/">https://developers.google.com/speed/pagespeed/</a></p>-->
                    </section>
                    <section id="timeline">
                        <h2>Page load timeline</h2>
                        <table class="no-border">
                            <tbody>
                                <tr class="progress-bar">
                                    <td class="bg-yellow">redirections</td>
                                    <td class="bg-olive">DNS</td>
                                    <td class="bg-orange">TCP</td>
                                    <td class="bg-blue">request<br/>response</td>
                                    <td class="border-round-right bg-green">rendering</td>
                                </tr>
                                <tr class="fragment">
                                    <td class="border-left">minimize<br/>redirection</td>
                                    <td class="border-left">reduce<br/>lookups</td>
                                    <td class="border-left">image<br/>spriting<br/><br/>minify</td>
                                    <td class="border-left">caching<br/><br/>domain<br/>sharding</td>
                                    <td class="border-left">css on top<br/><br/>js at bottom</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="fragment">
                            <small>
                                <span>Similar graph:</span>
                                <a href="http://www.w3.org/TR/navigation-timing/#processing-model">http://www.w3.org/TR/navigation-timing/#processing-model</a>
                            </small>
                        </p>
                    </section>
                </section>

                <section id="redirect">
                    <section id="redirect-timeline">
                        <h2>Redirections</h2>
                        <table class="no-border">
                            <tbody>
                                <tr class="progress-bar">
                                    <td class="bg-yellow">redirections</td>
                                    <td class="bg-olive">DNS</td>
                                    <td class="bg-orange">TCP</td>
                                    <td class="bg-blue">request<br/>response</td>
                                    <td class="border-round-right bg-green">rendering</td>
                                </tr>
                                <tr>
                                    <td class="border-left">minimize<br/>redirection</td>
                                    <td class="border-left" colspan="4"></td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section id="min-redirections">
                        <h2>Minimize Redirections</h2>
                        <ul>
                            <li>Links/forms</li>
                            <li>HTTP 3XX status codes</li>
                            <li>
                                <span>HTML meta refresh</span>
                                <pre><code class="html" data-trim>&lt;meta http-equiv="refresh" content="5; url=http://example.com/"&gt;</code></pre>
                            </li>
                            <li>
                                <span>JavaScript</span>
                                <pre><code class="javascript" data-trim>
window.location.reload(true); // document.location?
window.location.replace("http://www.z.cn");
window.location.assign("http://www.z.cn");
window.location.href = "http://www.z.cn";
window.location = "http://www.z.cn";
window.history.forward();
window.history.back();
window.history.go(-1);
                                </code></pre>
                            </li>
                        </ul>
                    </section>
                </section>

                <section id="dns">
                    <section id="dns-timeline">
                        <h2>DNS</h2>
                        <table class="no-border">
                            <tbody>
                                <tr class="progress-bar">
                                    <td class="bg-yellow">redirections</td>
                                    <td class="bg-olive">DNS</td>
                                    <td class="bg-orange">TCP</td>
                                    <td class="bg-blue">request<br/>response</td>
                                    <td class="border-round-right bg-green">rendering</td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td class="border-left">reduce<br/>lookups</td>
                                    <td class="border-left" colspan="3"></td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section id="how-dns-works">
                        <h2>DNS lookup</h2>
                        <p><a href="//www.google.com">www.google.com</a></p>
                        <ol style="width:45%">
                            <li><em class="fragment highlight-blue">Browser/OS</em> cache</li>
                            <li><em class="fragment highlight-blue">Intranet</em> cache</li>
                            <li><em class="fragment highlight-red">ISP/local</em> cache</li>
                            <li><em class="fragment highlight-blue">Root</em> name server</li>
                            <li><em class="fragment highlight-blue">.com</em> name server</li>
                            <li><em class="fragment highlight-blue">google.com</em> name server</li>
                        </ol>
                    </section>
                    <section id="how-fast-local-dns">
                        <h2>How fast is your local DNS?</h2>
                        <p>
                            <a href="chrome://histograms/DNS.ResolveSuccess">chrome://histograms/DNS.ResolveSuccess</a>
                        </p>
                        <ul>
                            <li class="color-green">Good: &lt;30ms</li>
                            <li class="color-yellow">Average: 30-100ms</li>
                            <li class="color-orange">Ouch: 100ms+</li>
                        </ul>
                    </section>
                    <section id="httpdns">
                        <h2>HttpDNS</h2>
                        <ul>
                            <li>1st request: Http gets nearest server IP</li>
                            <li>Subsequent: nearest server IP</li>
                        </ul>
                        <p>
                            <a href="http://mp.weixin.qq.com/s?__biz=MzA3ODgyNzcwMw==&mid=201837080&idx=1&sn=b2a152b84df1c7dbd294ea66037cf262&scene=2&from=timeline&isappinstalled=0#rd">全局精确流量调度新思路-HttpDNS服务详解</a><br/>
                            <a href="http://mp.weixin.qq.com/s?__biz=MzAwMDU1MTE1OQ==&mid=209805123&idx=1&sn=ced8d67c3e2cc3ca38ef722949fa21f8&scene=2&srcid=WNjSToklLOOIrJ4xkgUA&from=timeline&isappinstalled=0#rd">App域名劫持之DNS高可用 - 开源版HttpDNS方案详解</a>
                        </p>
                    </section>
                    <section id="dns-prefetch">
                        <h2>DNS prefetch</h2>
                        <pre>
                            <code class="html">&lt;link rel="dns-prefetch" href="www.microstrategy.com"&gt;</code>
                        </pre>
                        <p>Hint browser to pre-resolve these names</p>
                        <p>Supported: Chrome, Firefox, Safari, IE9+</p>
                        <p><a href="chrome://dns/">chrome://dns/</a></p>
                    </section>
                </section>

                <section id="tcp">
                    <section id="tcp-landing">
                        <h2>TCP</h2>
                        <table class="no-border">
                            <tbody>
                                <tr class="progress-bar">
                                    <td class="bg-yellow">redirections</td>
                                    <td class="bg-olive">DNS</td>
                                    <td class="bg-orange">TCP</td>
                                    <td class="bg-blue">request<br/>response</td>
                                    <td class="border-round-right bg-green">rendering</td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td class="border-left">image<br/>spriting<br/><br/>minify</td>
                                    <td class="border-left" colspan="2"></td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section id="tcp-handshake">
                        <h2>TCP 3-way handshake</h2>
                        <table class="fragment no-border align-center">
                            <tbody>
                                <tr>
                                    <td rowspan="3" class="square border-round bg-olive">Host A</td>
                                    <td class="fragment">-----SYN-----&gt;</td>
                                    <td rowspan="3" class="square border-round bg-green">Host B</td>
                                </tr>
                                <tr>
                                    <td class="fragment">&lt;---SYN ACK---</td>
                                </tr>
                                <tr>
                                    <td class="fragment">-----ACK-----&gt;</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="fragment" style="margin-top:2em">
                            <small>
                                See <a href="http://www.inetdaemon.com/tutorials/internet/tcp/3-way_handshake.shtml">TCP 3-Way Handshake (SYN,SYN-ACK,ACK)</a>
                            </small>
                        </p>
                    </section>
                    <section id="tcp-slow-start">
                        <h2>TCP Slow Start</h2>
                        <img data-src="images/tcp-slow-start-min.jpg" alt="TCP Slow Start" />
                    </section>
                    <section>
                        <h2>TCP Slow Start</h2>
                        <p><a href="https://en.wikipedia.org/wiki/Slow-start">Wikipedia: Slow Start</a></p>
                        <p><a href="http://www.cdnplanet.com/blog/tune-tcp-initcwnd-for-optimum-performance/">Tuning initcwnd for optimum performance</a></p>
                        <p><a style="font-size:80%" href="http://www.lognormal.com/blog/2012/09/27/linux-tcpip-tuning/">Linux TCP/IP tuning for scalability (tcp_slow_start_after_idle)</a></p>
                    </section>
                </section>

                <section id="req-resp">
                    <section>
                        <h2>Request &amp; Response</h2>
                        <table class="no-border">
                            <tbody>
                                <tr class="progress-bar">
                                    <td class="bg-yellow">redirections</td>
                                    <td class="bg-olive">DNS</td>
                                    <td class="bg-orange">TCP</td>
                                    <td class="bg-blue">request<br/>response</td>
                                    <td class="border-round-right bg-green">rendering</td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td class="border-left">caching<br/><br/>domain<br/>sharding</td>
                                    <td class="border-left"></td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section id="caching">
                        <h2>Caching</h2>
                        <p>
                            <a href="https://www.mnot.net/cache_docs/">Caching Tutorial</a> by <a href="https://www.mnot.net/personal/">Mark Nottingham</a>
                        </p>
                        <p>Check your pages with <a href="https://redbot.org/">REDbot</a></p>
                    </section>
                    <section id="domain-sharding">
                        <h2>Domain Sharding</h2>
                        <table class="no-border align-center">
                            <tbody>
                                <tr>
                                    <td style="width:30%" class="square border-round bg-blue">Browser</td>
                                    <td>
                                        <small>2(1999) simultaneous connections</small>
                                        <small class="fragment">6-8(2010) simultaneous connections</small>
                                    </td>
                                    <td style="width:30%" class="square border-round bg-yellow">Domain</td>
                                </tr>
                            </tbody>
                        </table>
                        <p style="margin-top:2em" class="fragment">
                            <small>
                                <a href="http://www.mobify.com/blog/domain-sharding-bad-news-mobile-performance/">http://www.mobify.com/blog/domain-sharding-bad-news-mobile-performance/</a>
                            </small>
                        </p>
                    </section>
                    <section id="resource-prefetch">
                        <h2>Resource Prefetch</h2>
                        <pre>
                            <code class="html" data-trim>
&lt;link rel="prefetch" href="next-page.css"&gt;
&lt;link rel="subresource" href="critical.js"&gt;
                            </code>
                        </pre>
                        <ul>
                            <li>
                                <span>prefetch</span>
                                <ul>
                                    <li>Low-priority download of resources to be used on subsequent pages</li>
                                    <li>Chrome, Firefox, Safari, IE9+</li>
                                </ul>
                            <li>
                                <span>subresource</span>
                                <ul>
                                    <li>Early loading of resources within the current page</li>
                                    <li>Chrome only</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                </section>

                <section id="rendering">
                    <section>
                        <h2>Rendering</h2>
                        <table class="no-border">
                            <tbody>
                                <tr class="progress-bar">
                                    <td class="bg-yellow">redirections</td>
                                    <td class="bg-olive">DNS</td>
                                    <td class="bg-orange">TCP</td>
                                    <td class="bg-blue">request<br/>response</td>
                                    <td class="border-round-right bg-green">rendering</td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td class="border-left">css on top<br/><br/>js at bottom</td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section id="inline-critical">
                        <h2>Inline critical resources</h2>
                        <img data-src="images/inline-critical-resources-min.png" alt="Inline Critical Resources" />
                        <p class="fragment">
                            <small>
                                <a href="http://www.smashingmagazine.com/2015/08/understanding-critical-css/">http://www.smashingmagazine.com/2015/08/understanding-critical-css/</a>
                            </small>
                        </p>
                    </section>
                    <section id="async-non-critical">
                        <p>Alva Cheung</p>
                        <blockquote cite="http://velocity.oreilly.com.cn/2015/ppts/Alva-Cheung_delight-users_20150811.pdf" style="width:80%">&ldquo;Load non-critical features asynchronously&rdquo;</blockquote>
                        <p>
                            <small>
                                <a href="https://code.facebook.com/posts/991252547593574/the-technology-behind-preview-photos/">Facebook - The technology behind preview photos</a>
                            </small>
                        </p>
                    </section>
                    <section id="prerender">
                        <h2>Prerender</h2>
                        <pre>
                            <code class="html" data-trim>&lt;link rel="prerender" href="http://www.microstrategy.com"&gt;</code>
                        </pre>
                        <p>Initiate background pre-render of entire page</p>
                        <p>Supported: Chrome, Firefox</p>
                        <p>
                            <a href="chrome://net-internals/#prerender">chrome://net-internals/#prerender</a>
                        </p>
                        <p>
                            <a href="chrome://predictors/">chrome://predictors/</a>
                        </p>
                    </section>
                    <section id="js-rendering">
                        <h2>JavaScript rendering</h2>
                        <p>Why care?</p>
                        <table class="bordered align-center" style="width:60%">
                            <thead style="font-size:.8em">
                                <th>Static Web Pages</th>
                                <th>Interactive</th>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="width:49.99%;padding:0 1em 1em 1em">
                                        <table class="no-border">
                                            <span class="square border-round bg-yellow" style="margin-top:1em">CSS</span>
                                            <span class="square border-round bg-green" style="margin-top:1em">HTML</span>
                                            <span class="square border-round bg-blue" style="margin-top:1em">JavaScript</span>
                                        </table>
                                    </td>
                                    <td style="width:49.99%;padding:0 1em 1em 1em">
                                        <table class="no-border">
                                            <span class="square border-round bg-yellow" style="margin-top:1em">CSS</span>
                                            <span class="square border-round bg-blue" style="margin-top:1em">JavaScript</span>
                                            <span class="square border-round bg-green" style="margin-top:1em">HTML</span>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="fragment"><a href="https://angularjs.org">AngularJS</a>, <a href="http://facebook.github.io/react/">React</a></p>
                    </section>
                    <section id="inline-caching">
                        <h2>Inline Caching</h2>
                        <p>Speed up runtime method binding by remembering the results of a previous method lookup directly at the call site</p>
                        <p>
                            <a href="https://en.wikipedia.org/wiki/Inline_caching">https://en.wikipedia.org/wiki/Inline_caching</a>
                        </p>
                    </section>
                    <section id="break-ic1">
                        <h2>Inline Caching can be easily broken</h2>
                        <pre><code class="javascript" style="padding:1em" data-trim contenteditable>
function addTwoThings(thing1, thing2) {
    return thing1 + thing2;
}

addTwoThings(1, 2);
addTwoThings(100, 200); /* fast */
addTwoThings('a', 'b'); /* slow */
                        </code></pre>
                        <pre>
                            <code class="javascript" style="padding:1em" data-trim contenteditable>
function Dog(name) {
    this.name = name;
}

var dog1 = new Dog('Jim'); /* hidden class C1 */
var dog2 = new Dog('Bin'); /* hidden class C2 */
dog2.gender = 'male';
                        </code></pre>
                    </section>
                    <section id="css-rendering">
                        <h2>CSS rendering</h2>
                        <ul>
                            <li>
                                <span>Reflow</span>
                                <ul>
                                    <li>relocate elements</li>
                                    <li>change content</li>
                                    <li>window resize</li>
                                </ul>
                            </li>
                            <li>
                                <span>Repaint</span>
                                <ul>
                                    <li>change color</li>
                                    <li>change background color</li>
                                    <li>change visibility</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                    <section id="event-throttling">
                        <h2>Event debouncing/throtting</h2>
                        <p>onresize, onscroll...etc</p>
                    </section>
                    <section id="dom-change-queue">
                        <h2>Use the DOM change queue</h2>
                        <pre>
                            <code class="javascript" data-trim contenteditable>
var $div = $('#content')
var elements = ['a', 'b', 'c', 'd'];
for(var i=0,l=elements.length; i&lt;l; i++) {
    $div.append(elements[i]);
}
                            </code>
                        </pre>
                        <pre class="fragment"><code class="javascript" data-trim contenteditable>
var $div = $('#content')
var elements = ['a', 'b', 'c', 'd'];
for(var i=0,l=elements.length; i&lt;l; i++) {
    // one line of evilness
    var a = $(window).scrollTop;
    $div.append(elements[i]);
}
                        </code></pre>
                    </section>
                    <section id="paint-speed">
                        <h2>Painting performance</h2>
                        <ul>
                            <li>Minimize DOM depth</li>
                            <li>Minimize z-index depth</li>
                            <li>Minimize CSS rules</li>
                            <li>
                                <span>Use faster selectors</span>
                                <ul style="font-size:.7em">
                                    <li>Avoid descendant selector</li>
                                    <li>
                                        <span>Structure selector right to left</span>
                                        <pre><code class="css" data-trim>.class ul li a { color: blue; }</code></pre>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <span>Use expensive properties sparingly</span>
                                <pre><code class="css" data-trim>border-radius; box-shadow; transform,filter; :nth-child; position:fixed;</code></pre>
                            </li>
                            <li>
                                <span>Don't use universal selectors</span>
                                <pre><code class="css" data-trim>*; [disabled]; [type="text"]</code></pre>
                            </li>
                        </ul>
                        <p>
                            <small>
                                <a href="http://johnotander.com/css/2015/06/10/css-performance/">Improving CSS Performance</a>
                            </small>
                        </p>
                    </section>
                </section>

                <section id="http2">
                    <section id="http2-is-here">
                        <h2>Prepare for HTTP/2</h2>
                        <p>
                            <a href="http://httpwg.github.io/specs/rfc7540.html">IETF RFC 7540</a>
                        </p>
                        <img data-src="images/http2-chrome-min.png" alt="HTTP2 Chrome net-internals" />
                    </section>
                    <section id="http2-aims">
                        <h2>HTTP/2 Aims</h2>
                        <ol>
                            <li>Reduce latency</li>
                            <li>Reduce total number of TCP connections<br/>i.e., reduce number of open sockets</li>
                            <li>Better web security</li>
                            <li>Maintain compatibility with HTTP/1.1<br/>clients and server</li>
                            <li>Maintain same usability as HTTP/1.1<br/>i.e., can be used wherever we use HTTP/1.1</li>
                            <li>Better web security</li>
                        </ol>
                    </section>
                    <section id="http2-features">
                        <h2>HTTP/2 Features</h2>
                        <ol>
                            <li>Multiplexing<br><small>Multiple asynchronous HTTP requests over a single TCP connection.</small></li>
                            <li>Server Push<br><small>Multiple responses for single request</small></li>
                            <li>Header Compression<br><small>Compress HTTP headers along with content.</small></li>
                            <li>Request prioritization<br><small>While making multiple HTTP requests to a same domain they can be prioritized.</small></li>
                            <li>Binary Protocol<br><small>HTTP/2 is binary protocol whereas HTTP/1.1 is text protocol.</small></li>
                        </ol>
                        <p>
                            <small>
                                <a href="http://qnimate.com/post-series/http2-complete-tutorial/">HTTP/2 Complete Tutorial</a>
                            </small>
                        </p>
                    </section>
                    <section id="http2-compatibility">
                        <h2>HTTP/2 Compatibility</h2>
                        <table class="bordered align-center" style="font-size:.8em">
                            <thead>
                                <tr>
                                    <th>Request</th>
                                    <th colspan="2">Response</th>
                                </tr>
                                <tr>
                                    <th>HTTP/2 Client</th>
                                    <th>HTTP/1.1 Server</th>
                                    <th>HTTP/2 Server</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding:0">
                                        <pre><code class="http" style="padding:.8em" data-trim>
GET / HTTP/1.1
Host: server.example.com
Connection: Upgrade, HTTP2-Settings
Upgrade: h2c
HTTP2-Settings: &lt;payload&gt;
                                        </code></pre>
                                    </td>
                                    <td style="padding:0">
                                        <pre><code class="http" style="padding:.8em" data-trim>HTTP/1.1 200 OK
Content-Length: 243
Content-Type: text/html

...
                                        </code></pre>
                                    </td>
                                    <td style="padding:0">
                                        <pre><code class="http" style="padding:.8em" data-trim>
HTTP/1.1 101 Switching Protocols
Connection: Upgrade
Upgrade: h2c

[ HTTP/2 connection ...
                                        </code></pre>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <p>
                            <a href="http://httpwg.github.io/specs/rfc7540.html#rfc.section.3.2">See IETF RFC 7540</a>
                        </p>
                    </section>
                    <section id="http2-mulplexing">
                        <h2>Mulplexing in HTTP/2</h2>
                        <ul>
                            <li>
                                <span>HTTP/1.1 Pipelining</span>
                                <ul class="fragment">
                                    <li>Multiple HTTP requests are sent on a single TCP connection asynchronously</li>
                                    <li>Server responses synchronously</li>
                                    <li>First-in-first-out</li>
                                    <li>Head-of-line (HOL) blocking, <a href="https://en.wikipedia.org/wiki/Head-of-line_blocking">see Wiki</a></li>
                                </ul>
                            </li>
                            <li class="fragment">
                                <span>HTTP/2 Mulplexing</span>
                                <ul>
                                    <li>Streams and frames<br/><small>Every HTTP/2 request and response is given a unique id called as stream id</small></li>
                                    <li>Server also responses asynchronously</li>
                                    <li>The request and response both happen parallelly</li>
                                </ul>
                            </li>
                        </ul>
                    </section>
                    <section id="http2-server-push">
                        <h2>Server push in HTTP/2</h2>
                        <ul>
                            <li>Server sends multiple responses for a single request</li>
                            <li>A client can request that server push be disabled</li>
                            <li>A client cannot push</li>
                        </ul>
                        <p>
                            <a href="http://httpwg.github.io/specs/rfc7540.html#rfc.section.8.2">IETF RFC 7540, Section 8.2 Server Push</a>
                        </p>
                    </section>
                    <section id="http2-header-compression">
                        <h2>Header compression in HTTP/2</h2>
                        <ul>
                            <li class="fragment highlight-blue">A technique of not sending the same headers again</li>
                            <li>Client and server maintain a headers table containing the last response and request headers</li>
                            <li>For the first request or response they send all the required header</li>
                            <li>For subsequent requests client and server omit headers which are same as the previous request or response</li>
                        </ul>
                        <p>
                            <a href="https://tools.ietf.org/html/rfc7541">IETF RFC 7541, HPACK: Header Compression for HTTP/2</a>
                        </p>
                    </section>
                </section>

                <section id="https">
                    <section id="what-is-https">
                        <h2>HTTPS</h2>
                        <p>HTTP + <span class="color-green">SSL/TLS</span> = HTTPS</p>
                        <ul>
                            <li class="fragment">
                                <strong>Authentication</strong><br/>
                                <small>Am I talking to who they claim to be?</small>
                            </li>
                            <li class="fragment">
                                <strong>Data integrity</strong><br/>
                                <small>Has anyone tampered with the data?</small>
                            </li>
                            <li class="fragment">
                                <strong>Encryption</strong><br/>
                                <small>Can anyone see my conversation?</small>
                            </li>
                        </ul>
                        <p class="fragment color-green"><strong>Equally Important!</strong></p>
                    </section>
                    <section id="https-encryption">
                        <h2>Encyption</h2>
                        <ul>
                            <li>Handshake: asymmetric crypto</li>
                            <li>Application data transfer: symmetric crypto</li>
                        </ul>
                        <p>
                            <small>
                                <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer Security</a>
                            </small>
                        </p>
                    </section>
                    <section id="https-not-slow">
                        <h2>Is HTTPS slow?</h2>
                        <ul>
                            <li>Extra CPU costs</li>
                            <li>Extra roundtrips</li>
                        </ul>
                        <p><a href="https://istlsfastyet.com/">IsTlsFastYet.com</a>:</p>
                        <blockquote cite="https://istlsfastyet.com/">
                            &ldquo;TLS has exactly one performance problem: it is not used widely enough.<br/>Everything else can be optimized.&rdquo;
                        </blockquote>
                        <p>
                            <span>Dive deeper:</span>
                            <a href="https://www.youtube.com/watch?v=0EB7zh_7UE4">YouTube - Is TLS Fast Yet?</a>
                        </p>
                    </section>
                    <section id="https-howto">
                        <h2>HTTPS</h2>
                        <ul>
                            <li>Get a 2048-bit TLS certificate</li>
                            <li>Eliminate both <em>Yello Triangle</em> and <em>Shield</em></li>
                            <li>Use latest version of Kernal, OpenSSl and Apache/Nginx</li>
                            <li>Use SPDY3.1 &amp; HTTP/2</li>
                            <li>
                                <span>Use protocol relative URIs</span>
                                <pre><code class="html" data-trim>&lt;script src="//code.jquery.com/jquery-1.11.3.min.js"&gt;&lt;/script&gt;</code></pre>
                            </li>
                            <li>HTTP URL --&gt; 301 --&gt; HTTPS URL</li>
                            <li>Apply HSTS</li>
                        </ul>
                        <p>
                            <a href="https://wiki.mozilla.org/Security/Server_Side_TLS">Mozilla Wiki</a><br/>
                            <a href="https://www.ssllabs.com/ssltest/">Qualys SSL Labs</a><br/>
                        </p>
                    </section>
                    <section id="https-hsts">
                        <h2>HTTP Strict Transport Security (HSTS)</h2>
                        <pre>
                            <code class="http" data-trim>Strict-Transport-Security: max-age=10886400; includeSubDomains</code>
                        </pre>
                        <p>Browser remembers (for specified max-age period) that it should automatically request HTTPS resources for this site and its subdomains.</p>
                        <p>HSTS eliminates HTTP --&gt; HTTPS redirects.</p>
                    </section>
                </section>

                <section id="web-dev-resources">
                    <h2>Web Dev Resources</h2>
                    <ul>
                        <li><a href="https://wdrl.info/">Web Development Reading List</a></li>
                    </ul>
                </section>

                <section id="references">
                    <h2>References</h2>
                    <ol style="width:99%">
                        <li><a href="http://velocity.oreilly.com.cn/2015/index.php?func=slidesvideos">The Quest to Delight Our Users</a> by <a href="https://www.linkedin.com/in/alvacheung">Alva Cheung(Google)</a></li>
                        <li><a href="http://velocity.oreilly.com.cn/2015/index.php?func=slidesvideos">eBay对页面性能的监控和调优</a> by <a href="mailto:weishi@ebay.com">施尉霁(eBay)</a></li>
                        <li><a href="http://velocity.oreilly.com.cn/2015/index.php?func=slidesvideos">淘宝全站HTTPS实践</a> by 李振宇(阿里巴巴)</li>
                        <li><a href="https://www.youtube.com/watch?v=cBhZ6S0PFCY">Google I/O 2014 - HTTPS Everywhere</a></li>
                        <li><a href="http://www.slideshare.net/MilanAryal/preconnect-prefetch-prerender">Preconnect, prefetch, prerender</a> by <a href="igrigorik@google.com">Ilya Grigorik</a></li>
                        <li><a href="https://w3c.github.io/resource-hints/">Resource Hints</a></li>
                    </ol>
                </section>

                <section id="references">
                    <h1>Thanks!</h1>
                    <img width="369" height="403" data-src="images/qr-yan-wechat-min.png" alt="Yan Li WeChat ID" />
                    <p>WeChat ID: peterleepersonal</p>
                </section>
            </div>
        </div>
        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.min.js"></script>
        <script>
            // Full list of configuration options available at:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                transition: 'convex', // none/fade/slide/convex/concave/zoom

                // Optional reveal.js plugins
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.min.js', async: true }
                ]
            });
        </script>
    </body>
</html>
